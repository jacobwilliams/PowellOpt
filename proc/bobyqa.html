<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="PowellOpt -- Optimization algorithms by M.J.D. Powell">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>bobyqa &ndash; PowellOpt</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">PowellOpt </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>bobyqa
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 1.2% of total for procedures.">74 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/bobyqa.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/bobyqa.f90.html'>bobyqa.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/bobyqa_module.html'>bobyqa_module</a></li>
            <li class="breadcrumb-item active" aria-current="page">bobyqa</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/bobyqa.html#src">bobyqa</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine bobyqa(n, npt, x, xl, xu, rhobeg, rhoend, iprint, maxfun, calfun)  
</h2>
    

    <p>This subroutine seeks the least value of a function of many variables,
by applying a trust region method that forms quadratic models by
interpolation. There is usually some freedom in the interpolation
conditions, which is taken up by minimizing the Frobenius norm of
the change to the second derivative of the model, beginning with the
zero matrix. The values of the variables are constrained by upper and
lower bounds.</p>
<p>In addition to providing CALFUN, an initial vector of variables and
the lower and upper bounds, the user has to set the values of the parameters
<code>RHOBEG</code>, <code>RHOEND</code> and <code>NPT</code>. After scaling the individual variables
if necessary, so that the magnitudes of their expected changes are similar,
<code>RHOBEG</code> is the initial steplength for changes to the variables, a reasonable choice
being the mesh size of a coarse grid search. Further, <code>RHOEND</code> should be suitable for
a search on a very fine grid. Typically, the software calculates a vector
of variables that is within distance <code>10*RHOEND</code> of a local minimum. Another
consideration is that every trial vector of variables is forced to satisfy
the lower and upper bounds, but there has to be room to make a search in all
directions. Therefore an error return occurs if the difference between the
bounds on any variable is less than <code>2*RHOBEG</code>. The parameter <code>NPT</code> specifies
the number of interpolation conditions on each quadratic model, the value
<code>NPT=2*N+1</code> being recommended for a start, where <code>N</code> is the number of
variables. It is often worthwhile to try other choices too, but much larger values
tend to be inefficient, because the amount of routine work of each iteration is
of magnitude <code>NPT**2</code>, and because the achievement of adequate accuracy in some
matrix calculations becomes more difficult. Some excellent numerical results
have been found in the case <code>NPT=N+6</code> even with more than 100 variables.</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-n~34"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>
                <p>number of variables (must be at least two)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-npt~17"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>npt</strong></td>
            <td>
                <p>number of interpolation conditions. Its value must be in
the interval [N+2,(N+1)(N+2)/2]. Choices that exceed 2*N+1 are not
recommended.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~23"></span>
              real(kind=wp),
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>x</strong></td>
            <td>
                <p>Initial values of the variables must be set in X(1),X(2),...,X(N). They
will be changed to the values that give the least calculated F.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xl"></span>
              real(kind=wp),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>xl</strong></td>
            <td>
                <p>lower bounds on x. The construction of quadratic models
requires XL(I) to be strictly less than XU(I) for each I. Further,
the contribution to a model from changes to the I-th variable is
damaged severely by rounding errors if XU(I)-XL(I) is too small.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xu"></span>
              real(kind=wp),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>xu</strong></td>
            <td>
                <p>upper bounds on x. The construction of quadratic models
requires XL(I) to be strictly less than XU(I) for each I. Further,
the contribution to a model from changes to the I-th variable is
damaged severely by rounding errors if XU(I)-XL(I) is too small.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rhobeg~14"></span>
              real(kind=wp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rhobeg</strong></td>
            <td>
                <p>RHOBEG must be set to the initial value of a trust region radius.
It must be positive, and typically should be about one tenth of the greatest
expected change to a variable.  An error return occurs if any of
the differences XU(I)-XL(I), I=1,...,N, is less than 2*RHOBEG.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rhoend~13"></span>
              real(kind=wp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rhoend</strong></td>
            <td>
                <p>RHOEND must be set to the final value of a trust
region radius. It must be positive with RHOEND no greater than
RHOBEG. Typically, RHOEND should indicate the
accuracy that is required in the final values of the variables.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iprint~14"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iprint</strong></td>
            <td>
                <p>IPRINT should be set to 0, 1, 2 or 3, which controls the
amount of printing. Specifically, there is no output if IPRINT=0 and
there is output only at the return if IPRINT=1. Otherwise, each new
value of RHO is printed, with the best vector of variables so far and
the corresponding value of the objective function. Further, each new
value of F with its variables are output if IPRINT=3.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxfun~13"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxfun</strong></td>
            <td>
                <p>an upper bound on the number of calls of CALFUN.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-calfun~11"></span>
              procedure(<a href='../interface/func~5.html'>func</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>calfun</strong></td>
            <td>
                <p>SUBROUTINE CALFUN (N,X,F) has to be provided by the user. It must set
F to the value of the objective function for the current values of the
variables X(1),X(2),...,X(N), which are generated automatically in a
way that satisfies the bounds given in XL and XU.</p>
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~bobyqa~~CallsGraph Pages: 1 -->
<svg id="procbobyqaCallsGraph" width="332pt" height="173pt"
 viewBox="0.00 0.00 332.00 172.79" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~bobyqa~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 168.79)">
<title>proc~~bobyqa~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-168.79 328,-168.79 328,4 -4,4"/>
<!-- proc~bobyqa -->
<g id="proc~~bobyqa~~CallsGraph_node1" class="node">
<title>proc~bobyqa</title>
<polygon fill="none" stroke="black" points="54,-80.79 0,-80.79 0,-56.79 54,-56.79 54,-80.79"/>
<text text-anchor="middle" x="27" y="-66.39" font-family="Helvetica,sans-Serif" font-size="10.50">bobyqa</text>
</g>
<!-- proc~bobyqb -->
<g id="proc~~bobyqa~~CallsGraph_node2" class="node">
<title>proc~bobyqb</title>
<g id="a_proc~~bobyqa~~CallsGraph_node2"><a xlink:href="../proc/bobyqb.html" xlink:title="bobyqb">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-80.79 90,-80.79 90,-56.79 144,-56.79 144,-80.79"/>
<text text-anchor="middle" x="117" y="-66.39" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bobyqb</text>
</a>
</g>
</g>
<!-- proc~bobyqa&#45;&gt;proc~bobyqb -->
<g id="proc~~bobyqa~~CallsGraph_edge1" class="edge">
<title>proc~bobyqa&#45;&gt;proc~bobyqb</title>
<path fill="none" stroke="#000000" d="M54.4,-68.79C62.39,-68.79 71.31,-68.79 79.82,-68.79"/>
<polygon fill="#000000" stroke="#000000" points="79.92,-72.29 89.92,-68.79 79.92,-65.29 79.92,-72.29"/>
</g>
<!-- proc~altmov -->
<g id="proc~~bobyqa~~CallsGraph_node3" class="node">
<title>proc~altmov</title>
<g id="a_proc~~bobyqa~~CallsGraph_node3"><a xlink:href="../proc/altmov.html" xlink:title="altmov">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-164.79 180,-164.79 180,-140.79 234,-140.79 234,-164.79"/>
<text text-anchor="middle" x="207" y="-150.39" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">altmov</text>
</a>
</g>
</g>
<!-- proc~bobyqb&#45;&gt;proc~altmov -->
<g id="proc~~bobyqa~~CallsGraph_edge2" class="edge">
<title>proc~bobyqb&#45;&gt;proc~altmov</title>
<path fill="none" stroke="#000000" d="M129.04,-80.8C141.15,-93.78 161.35,-114.89 180,-131.79 180.82,-132.53 181.66,-133.27 182.51,-134.02"/>
<polygon fill="#000000" stroke="#000000" points="180.46,-136.87 190.36,-140.63 184.97,-131.52 180.46,-136.87"/>
</g>
<!-- proc~prelim~2 -->
<g id="proc~~bobyqa~~CallsGraph_node4" class="node">
<title>proc~prelim~2</title>
<g id="a_proc~~bobyqa~~CallsGraph_node4"><a xlink:href="../proc/prelim~2.html" xlink:title="prelim">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-122.79 180,-122.79 180,-98.79 234,-98.79 234,-122.79"/>
<text text-anchor="middle" x="207" y="-108.39" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prelim</text>
</a>
</g>
</g>
<!-- proc~bobyqb&#45;&gt;proc~prelim~2 -->
<g id="proc~~bobyqa~~CallsGraph_edge3" class="edge">
<title>proc~bobyqb&#45;&gt;proc~prelim~2</title>
<path fill="none" stroke="#000000" d="M143.45,-80.94C152.21,-85.12 162.17,-89.87 171.52,-94.33"/>
<polygon fill="#000000" stroke="#000000" points="170.07,-97.52 180.6,-98.67 173.09,-91.2 170.07,-97.52"/>
</g>
<!-- proc~rescue -->
<g id="proc~~bobyqa~~CallsGraph_node5" class="node">
<title>proc~rescue</title>
<g id="a_proc~~bobyqa~~CallsGraph_node5"><a xlink:href="../proc/rescue.html" xlink:title="rescue">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-80.79 180,-80.79 180,-56.79 234,-56.79 234,-80.79"/>
<text text-anchor="middle" x="207" y="-66.39" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rescue</text>
</a>
</g>
</g>
<!-- proc~bobyqb&#45;&gt;proc~rescue -->
<g id="proc~~bobyqa~~CallsGraph_edge4" class="edge">
<title>proc~bobyqb&#45;&gt;proc~rescue</title>
<path fill="none" stroke="#000000" d="M144.4,-68.79C152.39,-68.79 161.31,-68.79 169.82,-68.79"/>
<polygon fill="#000000" stroke="#000000" points="169.92,-72.29 179.92,-68.79 169.92,-65.29 169.92,-72.29"/>
</g>
<!-- proc~trsbox -->
<g id="proc~~bobyqa~~CallsGraph_node6" class="node">
<title>proc~trsbox</title>
<g id="a_proc~~bobyqa~~CallsGraph_node6"><a xlink:href="../proc/trsbox.html" xlink:title="trsbox">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-38.79 180,-38.79 180,-14.79 234,-14.79 234,-38.79"/>
<text text-anchor="middle" x="207" y="-24.39" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">trsbox</text>
</a>
</g>
</g>
<!-- proc~bobyqb&#45;&gt;proc~trsbox -->
<g id="proc~~bobyqa~~CallsGraph_edge5" class="edge">
<title>proc~bobyqb&#45;&gt;proc~trsbox</title>
<path fill="none" stroke="#000000" d="M143.45,-56.64C152.21,-52.46 162.17,-47.71 171.52,-43.25"/>
<polygon fill="#000000" stroke="#000000" points="173.09,-46.37 180.6,-38.91 170.07,-40.06 173.09,-46.37"/>
</g>
<!-- proc~update~3 -->
<g id="proc~~bobyqa~~CallsGraph_node7" class="node">
<title>proc~update~3</title>
<g id="a_proc~~bobyqa~~CallsGraph_node7"><a xlink:href="../proc/update~3.html" xlink:title="update">
<polygon fill="#d9534f" stroke="#d9534f" points="324,-39.79 270,-39.79 270,-15.79 324,-15.79 324,-39.79"/>
<text text-anchor="middle" x="297" y="-25.39" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update</text>
</a>
</g>
</g>
<!-- proc~bobyqb&#45;&gt;proc~update~3 -->
<g id="proc~~bobyqa~~CallsGraph_edge6" class="edge">
<title>proc~bobyqb&#45;&gt;proc~update~3</title>
<path fill="none" stroke="#000000" d="M125.43,-56.71C135.58,-41.5 155.37,-16.1 180,-5.79 206.75,5.42 239.37,-2.49 263.2,-11.8"/>
<polygon fill="#000000" stroke="#000000" points="261.93,-15.06 272.51,-15.68 264.63,-8.6 261.93,-15.06"/>
</g>
<!-- proc~rescue&#45;&gt;proc~update~3 -->
<g id="proc~~bobyqa~~CallsGraph_edge7" class="edge">
<title>proc~rescue&#45;&gt;proc~update~3</title>
<path fill="none" stroke="#000000" d="M233.93,-56.71C242.36,-52.78 251.86,-48.36 260.84,-44.17"/>
<polygon fill="#000000" stroke="#000000" points="262.37,-47.32 269.95,-39.92 259.41,-40.97 262.37,-47.32"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~bobyqa~~CalledByGraph Pages: 1 -->
<svg id="procbobyqaCalledByGraph" width="175pt" height="32pt"
 viewBox="0.00 0.00 175.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~bobyqa~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~bobyqa~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 171,-28 171,4 -4,4"/>
<!-- proc~bobyqa -->
<g id="proc~~bobyqa~~CalledByGraph_node1" class="node">
<title>proc~bobyqa</title>
<polygon fill="none" stroke="black" points="167,-24 113,-24 113,0 167,0 167,-24"/>
<text text-anchor="middle" x="140" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">bobyqa</text>
</g>
<!-- proc~bobyqa_test -->
<g id="proc~~bobyqa~~CalledByGraph_node2" class="node">
<title>proc~bobyqa_test</title>
<g id="a_proc~~bobyqa~~CalledByGraph_node2"><a xlink:href="../proc/bobyqa_test.html" xlink:title="bobyqa_test">
<polygon fill="#d9534f" stroke="#d9534f" points="77,-24 0,-24 0,0 77,0 77,-24"/>
<text text-anchor="middle" x="38.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bobyqa_test</text>
</a>
</g>
</g>
<!-- proc~bobyqa_test&#45;&gt;proc~bobyqa -->
<g id="proc~~bobyqa~~CalledByGraph_edge1" class="edge">
<title>proc~bobyqa_test&#45;&gt;proc~bobyqa</title>
<path fill="none" stroke="#000000" d="M77.12,-12C85.47,-12 94.32,-12 102.63,-12"/>
<polygon fill="#000000" stroke="#000000" points="102.78,-15.5 112.78,-12 102.78,-8.5 102.78,-15.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">bobyqa</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">npt</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">xl</span><span class="p">,</span><span class="w"> </span><span class="n">xu</span><span class="p">,</span><span class="w"> </span><span class="n">rhobeg</span><span class="p">,</span><span class="w"> </span><span class="n">rhoend</span><span class="p">,</span><span class="w"> </span><span class="n">iprint</span><span class="p">,</span><span class="w"> </span><span class="n">maxfun</span><span class="p">,</span><span class="w"> </span><span class="n">calfun</span><span class="p">)</span>

<span class="w">        </span><span class="k">implicit none</span>

<span class="k">        </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w">       </span><span class="c">!! number of variables (must be at least two)</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">npt</span><span class="w">     </span><span class="c">!! number of interpolation conditions. Its value must be in</span>
<span class="w">                                                       </span><span class="c">!! the interval [N+2,(N+1)(N+2)/2]. Choices that exceed 2*N+1 are not</span>
<span class="w">                                                       </span><span class="c">!! recommended.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="w">       </span><span class="c">!! Initial values of the variables must be set in X(1),X(2),...,X(N). They</span>
<span class="w">                                                       </span><span class="c">!! will be changed to the values that give the least calculated F.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">xl</span><span class="w">      </span><span class="c">!! lower bounds on x. The construction of quadratic models</span>
<span class="w">                                                       </span><span class="c">!! requires XL(I) to be strictly less than XU(I) for each I. Further,</span>
<span class="w">                                                       </span><span class="c">!! the contribution to a model from changes to the I-th variable is</span>
<span class="w">                                                       </span><span class="c">!! damaged severely by rounding errors if XU(I)-XL(I) is too small.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">xu</span><span class="w">      </span><span class="c">!! upper bounds on x. The construction of quadratic models</span>
<span class="w">                                                       </span><span class="c">!! requires XL(I) to be strictly less than XU(I) for each I. Further,</span>
<span class="w">                                                       </span><span class="c">!! the contribution to a model from changes to the I-th variable is</span>
<span class="w">                                                       </span><span class="c">!! damaged severely by rounding errors if XU(I)-XL(I) is too small.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">rhobeg</span><span class="w">  </span><span class="c">!! RHOBEG must be set to the initial value of a trust region radius.</span>
<span class="w">                                                       </span><span class="c">!! It must be positive, and typically should be about one tenth of the greatest</span>
<span class="w">                                                       </span><span class="c">!! expected change to a variable.  An error return occurs if any of</span>
<span class="w">                                                       </span><span class="c">!! the differences XU(I)-XL(I), I=1,...,N, is less than 2*RHOBEG.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">rhoend</span><span class="w">  </span><span class="c">!! RHOEND must be set to the final value of a trust</span>
<span class="w">                                                       </span><span class="c">!! region radius. It must be positive with RHOEND no greater than</span>
<span class="w">                                                       </span><span class="c">!! RHOBEG. Typically, RHOEND should indicate the</span>
<span class="w">                                                       </span><span class="c">!! accuracy that is required in the final values of the variables.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">iprint</span><span class="w">  </span><span class="c">!! IPRINT should be set to 0, 1, 2 or 3, which controls the</span>
<span class="w">                                                       </span><span class="c">!! amount of printing. Specifically, there is no output if IPRINT=0 and</span>
<span class="w">                                                       </span><span class="c">!! there is output only at the return if IPRINT=1. Otherwise, each new</span>
<span class="w">                                                       </span><span class="c">!! value of RHO is printed, with the best vector of variables so far and</span>
<span class="w">                                                       </span><span class="c">!! the corresponding value of the objective function. Further, each new</span>
<span class="w">                                                       </span><span class="c">!! value of F with its variables are output if IPRINT=3.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">maxfun</span><span class="w">  </span><span class="c">!! an upper bound on the number of calls of CALFUN.</span>
<span class="w">        </span><span class="k">procedure</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">calfun</span><span class="w">  </span><span class="c">!! SUBROUTINE CALFUN (N,X,F) has to be provided by the user. It must set</span>
<span class="w">                                                       </span><span class="c">!! F to the value of the objective function for the current values of the</span>
<span class="w">                                                       </span><span class="c">!! variables X(1),X(2),...,X(N), which are generated automatically in a</span>
<span class="w">                                                       </span><span class="c">!! way that satisfies the bounds given in XL and XU.</span>

<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ibmat</span><span class="p">,</span><span class="n">id</span><span class="p">,</span><span class="n">ifv</span><span class="p">,</span><span class="n">igo</span><span class="p">,</span><span class="n">ihq</span><span class="p">,</span><span class="n">ipq</span><span class="p">,</span><span class="n">isl</span><span class="p">,</span><span class="n">isu</span><span class="p">,</span><span class="n">ivl</span><span class="p">,</span><span class="n">iw</span><span class="p">,</span><span class="n">ixa</span><span class="p">,&amp;</span>
<span class="w">                   </span><span class="n">ixb</span><span class="p">,</span><span class="n">ixn</span><span class="p">,</span><span class="n">ixo</span><span class="p">,</span><span class="n">ixp</span><span class="p">,</span><span class="n">izmat</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">jsl</span><span class="p">,</span><span class="n">jsu</span><span class="p">,</span><span class="n">ndim</span><span class="p">,</span><span class="n">np</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">w</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">temp</span>

<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span>

<span class="w">        </span><span class="c">! The array W will be used for working space.</span>
<span class="w">        </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">w</span><span class="p">((</span><span class="n">NPT</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">NPT</span><span class="o">+</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="c">!</span>
<span class="c">!     Return if the value of NPT is unacceptable.</span>
<span class="c">!</span>
<span class="w">        </span><span class="n">np</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">npt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">npt</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/4X,A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;Return from BOBYQA because NPT is not in the required interval&#39;</span>
<span class="w">            </span><span class="k">return</span>
<span class="k">        end if</span>
<span class="c">!</span>
<span class="c">!     Partition the working space array, so that different parts of it can</span>
<span class="c">!     be treated separately during the calculation of BOBYQB. The partition</span>
<span class="c">!     requires the first (NPT+2)*(NPT+N)+3*N*(N+5)/2 elements of W plus the</span>
<span class="c">!     space that is taken by the last array in the argument list of BOBYQB.</span>
<span class="c">!</span>
<span class="w">        </span><span class="n">ndim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">npt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">ixb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">ixp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ixb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">ifv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ixp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">npt</span>
<span class="w">        </span><span class="n">ixo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifv</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">npt</span>
<span class="w">        </span><span class="n">igo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ixo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">ihq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">igo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">ipq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ihq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span>
<span class="w">        </span><span class="n">ibmat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ipq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">npt</span>
<span class="w">        </span><span class="n">izmat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibmat</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ndim</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">isl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">izmat</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">npt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">npt</span><span class="o">-</span><span class="n">np</span><span class="p">)</span>
<span class="w">        </span><span class="n">isu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">ixn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">ixa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ixn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ixa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">ivl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">iw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ndim</span>
<span class="c">!</span>
<span class="c">!     Return if there is insufficient space between the bounds. Modify the</span>
<span class="c">!     initial X if necessary in order to avoid conflicts between the bounds</span>
<span class="c">!     and the construction of the first quadratic model. The lower and upper</span>
<span class="c">!     bounds on moves from the updated X are set now, in the ISL and ISU</span>
<span class="c">!     partitions of W, in order to provide useful and exact information about</span>
<span class="c">!     components of X that become within distance RHOBEG from their bounds.</span>
<span class="c">!</span>
<span class="w">        </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">            </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xu</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xl</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">temp</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">rhobeg</span><span class="o">+</span><span class="n">rhobeg</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/4X,A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="s1">&#39;Return from BOBYQA because one of the differences &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<span class="w">                    </span><span class="s1">&#39;XU(I)-XL(I) is less than 2*RHOBEG.&#39;</span>
<span class="w">                </span><span class="k">return</span>
<span class="k">            end if</span>
<span class="k">            </span><span class="n">jsl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">jsu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">            </span><span class="n">w</span><span class="w"> </span><span class="p">(</span><span class="n">jsl</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xl</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">            </span><span class="n">w</span><span class="w"> </span><span class="p">(</span><span class="n">jsu</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xu</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">jsl</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=-</span><span class="n">rhobeg</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">jsl</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">x</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xl</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">                    </span><span class="n">w</span><span class="w"> </span><span class="p">(</span><span class="n">jsl</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                    </span><span class="n">w</span><span class="w"> </span><span class="p">(</span><span class="n">jsu</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span>
<span class="w">                </span><span class="k">else</span>
<span class="k">                    </span><span class="n">x</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xl</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rhobeg</span>
<span class="w">                    </span><span class="n">w</span><span class="w"> </span><span class="p">(</span><span class="n">jsl</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rhobeg</span>
<span class="w">                    </span><span class="n">w</span><span class="w"> </span><span class="p">(</span><span class="n">jsu</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="w"> </span><span class="p">(</span><span class="n">xu</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="n">rhobeg</span><span class="p">)</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            else if</span><span class="w"> </span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">jsu</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">rhobeg</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">jsu</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">x</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xu</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">                    </span><span class="n">w</span><span class="w"> </span><span class="p">(</span><span class="n">jsl</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">temp</span>
<span class="w">                    </span><span class="n">w</span><span class="w"> </span><span class="p">(</span><span class="n">jsu</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                </span><span class="k">else</span>
<span class="k">                    </span><span class="n">x</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xu</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rhobeg</span>
<span class="w">                    </span><span class="n">w</span><span class="w"> </span><span class="p">(</span><span class="n">jsl</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="w"> </span><span class="p">(</span><span class="n">xl</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="o">-</span><span class="n">rhobeg</span><span class="p">)</span>
<span class="w">                    </span><span class="n">w</span><span class="w"> </span><span class="p">(</span><span class="n">jsu</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rhobeg</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">        end do</span>
<span class="c">!</span>
<span class="c">!     Make the call of BOBYQB.</span>
<span class="c">!</span>
<span class="w">        </span><span class="k">call </span><span class="n">bobyqb</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">npt</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">xl</span><span class="p">,</span><span class="w"> </span><span class="n">xu</span><span class="p">,</span><span class="w"> </span><span class="n">rhobeg</span><span class="p">,</span><span class="w"> </span><span class="n">rhoend</span><span class="p">,</span><span class="w"> </span><span class="n">iprint</span><span class="p">,</span><span class="w"> </span><span class="n">maxfun</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">ixb</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">ixp</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">         </span><span class="n">w</span><span class="p">(</span><span class="n">ifv</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">ixo</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">igo</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">ihq</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">ipq</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">ibmat</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">izmat</span><span class="p">),</span><span class="w"> </span><span class="n">ndim</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">isl</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">         </span><span class="n">w</span><span class="p">(</span><span class="n">isu</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">ixn</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">ixa</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">id</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">ivl</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">iw</span><span class="p">),</span><span class="w"> </span><span class="n">calfun</span><span class="p">)</span>

<span class="w">        </span><span class="k">deallocate</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="w">    </span><span class="k">end subroutine </span><span class="n">bobyqa</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              PowellOpt
 was developed by Jacob Williams<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>